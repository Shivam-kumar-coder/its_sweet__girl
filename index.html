<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>it's__sweet_girl‚ù§Ô∏è</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300&display=swap');

  body, html {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    background: #000;
    overflow: hidden;
    touch-action: none;
    -webkit-tap-highlight-color: transparent;
  }

  canvas {
    display: block;
    position: absolute;
    top: 0; left: 0;
  }

  /* Mobile Optimized Text Container */
  #text-container {
    position: absolute;
    bottom: 15%; 
    left: 0;
    width: 100%;
    text-align: center;
    z-index: 20;
    pointer-events: none;
  }

  #typewriter {
    font-family: 'Dancing Script', cursive;
    /* Responsive font size: minimum 28px, grows with screen */
    font-size: clamp(28px, 10vw, 50px);
    color: #ff4d6d;
    text-shadow: 0 0 10px rgba(255, 77, 109, 0.8), 0 0 20px rgba(255, 0, 64, 0.5);
    display: inline-block;
    padding: 0 15px;
    border-right: 3px solid #ff4d6d; /* Typewriter cursor */
    white-space: nowrap;
    animation: blink 0.7s infinite;
  }

  @keyframes blink { 
    0%, 100% { border-color: transparent; } 
    50% { border-color: #ff4d6d; } 
  }

  /* Start Screen Design */
  #start-screen {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at center, #2b0008 0%, #000 100%);
    color: #ff4d6d;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 100;
    text-align: center;
    transition: opacity 1s ease;
  }

  .heart-main {
    font-size: 80px;
    filter: drop-shadow(0 0 15px #ff0040);
    animation: pulse 1.2s infinite ease-in-out;
    cursor: pointer;
  }

  @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }

  .tap-text {
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
    letter-spacing: 2px;
    margin-top: 20px;
    text-transform: uppercase;
    animation: fadeText 2s infinite;
  }

  @keyframes fadeText { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
</style>
</head>

<body>

<div id="start-screen" onclick="startExperience()">
  <div class="heart-main">‚ù§Ô∏è</div>
  <div class="tap-text">Tap to Surprise Anjali</div>
</div>

<canvas id="bgCanvas"></canvas>
<canvas id="treeCanvas"></canvas>

<div id="text-container">
  <span id="typewriter"></span>
</div>

<audio id="music" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const bgCanvas = document.getElementById("bgCanvas");
const bgCtx = bgCanvas.getContext("2d");
const tCanvas = document.getElementById("treeCanvas");
const tCtx = tCanvas.getContext("2d");

let message = "it's_sweet ‚ô•Ô∏è Anjali";
let treeQueue = [];
let textIndex = 0;
let floatingHearts = [];
let particles = [];

function resize() {
  bgCanvas.width = tCanvas.width = window.innerWidth;
  bgCanvas.height = tCanvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

class Heart {
  constructor(isTouch = false, x = 0, y = 0) {
    this.reset(isTouch, x, y);
  }
  reset(isTouch, x, y) {
    this.x = isTouch ? x : Math.random() * bgCanvas.width;
    this.y = isTouch ? y : bgCanvas.height + 20;
    this.size = isTouch ? Math.random() * 20 + 10 : Math.random() * 12 + 8;
    this.speedX = isTouch ? (Math.random() - 0.5) * 6 : (Math.random() - 0.5) * 1;
    this.speedY = isTouch ? (Math.random() - 2) * 4 : -(Math.random() * 1.5 + 0.5);
    this.opacity = 1;
    this.isTouch = isTouch;
    this.emoji = Math.random() > 0.5 ? "‚ù§Ô∏è" : "üç´";
  }
  update() {
    this.y += this.speedY;
    this.x += this.speedX;
    if (this.isTouch) this.opacity -= 0.02;
    if (this.y < -30 || this.opacity <= 0) {
      if (!this.isTouch) this.reset(false);
      return false;
    }
    return true;
  }
  draw() {
    bgCtx.globalAlpha = this.opacity;
    bgCtx.font = `${this.size}px serif`;
    bgCtx.fillText(this.emoji, this.x, this.y);
  }
}

function startExperience() {
  document.getElementById("start-screen").style.opacity = "0";
  setTimeout(() => document.getElementById("start-screen").remove(), 1000);
  
  const audio = document.getElementById("music");
  audio.play().catch(e => console.log("Audio play blocked"));

  for(let i=0; i<15; i++) floatingHearts.push(new Heart());

  const isSmall = window.innerWidth < 500;
  const treeBaseY = tCanvas.height * 0.8;
  const branchLen = isSmall ? tCanvas.height * 0.1 : tCanvas.height * 0.15;

  initTree(tCanvas.width / 2, treeBaseY, branchLen, -90, isSmall ? 9 : 10);
  animate();
  setTimeout(typeWriter, 800);
}

function initTree(x, y, len, angle, depth) {
  if (depth === 0) {
    treeQueue.push(() => {
      tCtx.fillStyle = "#ff4d6d";
      tCtx.shadowBlur = 10;
      tCtx.shadowColor = "#ff0040";
      tCtx.beginPath();
      tCtx.arc(x, y, 2.5, 0, Math.PI * 2);
      tCtx.fill();
    });
    return;
  }

  treeQueue.push(() => {
    let rad = angle * (Math.PI / 180);
    let nx = x + Math.cos(rad) * len;
    let ny = y + Math.sin(rad) * len;

    tCtx.beginPath();
    tCtx.strokeStyle = `hsl(345, 100%, ${40 + (10-depth)*4}%)`;
    tCtx.lineWidth = depth * 0.7;
    tCtx.lineCap = "round";
    tCtx.moveTo(x, y);
    tCtx.lineTo(nx, ny);
    tCtx.stroke();

    initTree(nx, ny, len * 0.76, angle - 22, depth - 1);
    initTree(nx, ny, len * 0.76, angle + 26, depth - 1);
  });
}

function typeWriter() {
  const el = document.getElementById("typewriter");
  if (textIndex < message.length) {
    el.textContent += message.charAt(textIndex);
    textIndex++;
    // Random speed for more natural feel
    let speed = message.charAt(textIndex-1) === " " ? 250 : 120;
    setTimeout(typeWriter, speed);
  } else {
    // Stop cursor blinking after typing
    el.style.borderRight = "none";
  }
}

function animate() {
  bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);

  floatingHearts = floatingHearts.filter(h => {
    if (h.update()) { h.draw(); return true; }
    return false;
  });

  particles = particles.filter(p => {
    if (p.update()) { p.draw(); return true; }
    return false;
  });

  if (treeQueue.length > 0) {
    let batch = Math.min(treeQueue.length, 4);
    for(let i=0; i<batch; i++) {
        treeQueue.shift()();
    }
  }

  requestAnimationFrame(animate);
}

window.addEventListener('touchstart', (e) => {
    for(let i=0; i<6; i++) {
        particles.push(new Heart(true, e.touches[0].clientX, e.touches[0].clientY));
    }
});
</script>
</body>
</html>
